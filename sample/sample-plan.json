{"format_version":"1.2","terraform_version":"1.8.2","variables":{"aws_account_id":{"value":"124355660096"},"aws_region":{"value":"us-west-2"},"environment":{"value":"dev"},"github_PAT_secret_name":{"value":"GITHUB_PAT_SECRET"},"github_PAT_secret_string":{"value":"secret"},"github_webhook_secret_name":{"value":"GITHUB_WEBHOOK_SECRET"},"github_webhook_secret_string":{"value":"secret2"},"lambda_runtime":{"value":"provided.al2023"},"project_name":{"value":"deployment-webhooks"}},"planned_values":{"outputs":{"dynamodb_table_arn":{"sensitive":false},"dynamodb_table_name":{"sensitive":false,"type":"string","value":"deployment-webhooks-dev-table"},"function_name":{"sensitive":false,"type":"string","value":"deployment-webhooks-dev-webhook-lambda"},"invoke_arn":{"sensitive":false}},"root_module":{"resources":[{"address":"aws_iam_policy.lambda_dynamodb_write_policy","mode":"managed","type":"aws_iam_policy","name":"lambda_dynamodb_write_policy","provider_name":"registry.opentofu.org/hashicorp/aws","schema_version":0,"values":{"description":"Policy to allow Lambda functions to fetch from DynamoDB","name":"lambda_dynamodb_policy","path":"/","tags":null,"tags_all":{"ManagedByTerraform":"true","environment":"dev"}},"sensitive_values":{"tags_all":{}}},{"address":"aws_iam_policy.secret_access","mode":"managed","type":"aws_iam_policy","name":"secret_access","provider_name":"registry.opentofu.org/hashicorp/aws","schema_version":0,"values":{"description":null,"name":"secrets-access-policy","path":"/","tags":null,"tags_all":{"ManagedByTerraform":"true","environment":"dev"}},"sensitive_values":{"tags_all":{}}},{"address":"aws_iam_role.lambda_execution","mode":"managed","type":"aws_iam_role","name":"lambda_execution","provider_name":"registry.opentofu.org/hashicorp/aws","schema_version":0,"values":{"assume_role_policy":"{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}","description":null,"force_detach_policies":false,"max_session_duration":3600,"name":"deployment-webhooks-dev-lambda-execution-role","path":"/","permissions_boundary":null,"tags":null,"tags_all":{"ManagedByTerraform":"true","environment":"dev"}},"sensitive_values":{"inline_policy":[],"managed_policy_arns":[],"tags_all":{}}},{"address":"aws_lambda_function.webhook","mode":"managed","type":"aws_lambda_function","name":"webhook","provider_name":"registry.opentofu.org/hashicorp/aws","schema_version":0,"values":{"architectures":["arm64"],"code_signing_config_arn":null,"dead_letter_config":[],"description":null,"environment":[{}],"file_system_config":[],"filename":"./../../../lambdas/webhook/build/lambda.zip","function_name":"deployment-webhooks-dev-webhook-lambda","handler":"bootstrap","image_config":[],"image_uri":null,"kms_key_arn":null,"layers":null,"memory_size":128,"package_type":"Zip","publish":false,"replace_security_groups_on_destroy":null,"replacement_security_group_ids":null,"reserved_concurrent_executions":-1,"runtime":"provided.al2023","s3_bucket":null,"s3_key":null,"s3_object_version":null,"skip_destroy":false,"snap_start":[],"source_code_hash":"624c649d10ceb4d884b01fae601b1f511bae7df7f949799a1067b7d8a223d821","tags":null,"tags_all":{"ManagedByTerraform":"true","environment":"dev"},"timeout":3,"timeouts":null,"vpc_config":[]},"sensitive_values":{"architectures":[false],"dead_letter_config":[],"environment":[{"variables":{}}],"ephemeral_storage":[],"file_system_config":[],"image_config":[],"logging_config":[],"snap_start":[],"tags_all":{},"tracing_config":[],"vpc_config":[]}}],"child_modules":[{"resources":[{"address":"module.dynamodb_table.aws_dynamodb_table.table","mode":"managed","type":"aws_dynamodb_table","name":"table","provider_name":"registry.opentofu.org/hashicorp/aws","schema_version":1,"values":{"attribute":[{"name":"login","type":"S"},{"name":"repo-env","type":"S"}],"billing_mode":"PROVISIONED","deletion_protection_enabled":null,"global_secondary_index":[],"hash_key":"login","import_table":[],"local_secondary_index":[],"name":"deployment-webhooks-dev-table","range_key":"repo-env","read_capacity":5,"replica":[],"restore_date_time":null,"restore_source_name":null,"restore_source_table_arn":null,"restore_to_latest_time":null,"stream_enabled":null,"table_class":null,"tags":null,"tags_all":{"ManagedByTerraform":"true","environment":"dev"},"timeouts":null,"write_capacity":5},"sensitive_values":{"attribute":[{},{}],"global_secondary_index":[],"import_table":[],"local_secondary_index":[],"point_in_time_recovery":[],"replica":[],"server_side_encryption":[],"tags_all":{},"ttl":[]}}],"address":"module.dynamodb_table"},{"resources":[{"address":"module.github_PAT_secret.aws_secretsmanager_secret.this","mode":"managed","type":"aws_secretsmanager_secret","name":"this","provider_name":"registry.opentofu.org/hashicorp/aws","schema_version":0,"values":{"description":"The secret for the GitHub PAT, used to approve requests.","force_overwrite_replica_secret":false,"kms_key_id":null,"name":"GITHUB_PAT_SECRET","recovery_window_in_days":0,"tags":null,"tags_all":{"ManagedByTerraform":"true","environment":"dev"}},"sensitive_values":{"replica":[],"tags_all":{}}},{"address":"module.github_PAT_secret.aws_secretsmanager_secret_version.this","mode":"managed","type":"aws_secretsmanager_secret_version","name":"this","provider_name":"registry.opentofu.org/hashicorp/aws","schema_version":0,"values":{"secret_binary":null,"secret_string":"secret"},"sensitive_values":{"secret_binary":true,"secret_string":true,"version_stages":[]}}],"address":"module.github_PAT_secret"},{"resources":[{"address":"module.github_webhook_secret.aws_secretsmanager_secret.this","mode":"managed","type":"aws_secretsmanager_secret","name":"this","provider_name":"registry.opentofu.org/hashicorp/aws","schema_version":0,"values":{"description":"The secret for the GitHub webhooks, used to verify payloads.","force_overwrite_replica_secret":false,"kms_key_id":null,"name":"GITHUB_WEBHOOK_SECRET","recovery_window_in_days":0,"tags":null,"tags_all":{"ManagedByTerraform":"true","environment":"dev"}},"sensitive_values":{"replica":[],"tags_all":{}}},{"address":"module.github_webhook_secret.aws_secretsmanager_secret_version.this","mode":"managed","type":"aws_secretsmanager_secret_version","name":"this","provider_name":"registry.opentofu.org/hashicorp/aws","schema_version":0,"values":{"secret_binary":null,"secret_string":"secret2"},"sensitive_values":{"secret_binary":true,"secret_string":true,"version_stages":[]}}],"address":"module.github_webhook_secret"}]}},"resource_changes":[{"address":"aws_iam_policy.lambda_dynamodb_write_policy","mode":"managed","type":"aws_iam_policy","name":"lambda_dynamodb_write_policy","provider_name":"registry.opentofu.org/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":"Policy to allow Lambda functions to fetch from DynamoDB","name":"lambda_dynamodb_policy","path":"/","tags":null,"tags_all":{"ManagedByTerraform":"true","environment":"dev"}},"after_unknown":{"arn":true,"attachment_count":true,"id":true,"name_prefix":true,"policy":true,"policy_id":true,"tags_all":{}},"before_sensitive":false,"after_sensitive":{"tags_all":{}}}},{"address":"aws_iam_policy.secret_access","mode":"managed","type":"aws_iam_policy","name":"secret_access","provider_name":"registry.opentofu.org/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":null,"name":"secrets-access-policy","path":"/","tags":null,"tags_all":{"ManagedByTerraform":"true","environment":"dev"}},"after_unknown":{"arn":true,"attachment_count":true,"id":true,"name_prefix":true,"policy":true,"policy_id":true,"tags_all":{}},"before_sensitive":false,"after_sensitive":{"tags_all":{}}}},{"address":"aws_iam_role.lambda_execution","mode":"managed","type":"aws_iam_role","name":"lambda_execution","provider_name":"registry.opentofu.org/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assume_role_policy":"{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}","description":null,"force_detach_policies":false,"max_session_duration":3600,"name":"deployment-webhooks-dev-lambda-execution-role","path":"/","permissions_boundary":null,"tags":null,"tags_all":{"ManagedByTerraform":"true","environment":"dev"}},"after_unknown":{"arn":true,"create_date":true,"id":true,"inline_policy":true,"managed_policy_arns":true,"name_prefix":true,"tags_all":{},"unique_id":true},"before_sensitive":false,"after_sensitive":{"inline_policy":[],"managed_policy_arns":[],"tags_all":{}}}},{"address":"aws_lambda_function.webhook","mode":"managed","type":"aws_lambda_function","name":"webhook","provider_name":"registry.opentofu.org/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"architectures":["arm64"],"code_signing_config_arn":null,"dead_letter_config":[],"description":null,"environment":[{}],"file_system_config":[],"filename":"./../../../lambdas/webhook/build/lambda.zip","function_name":"deployment-webhooks-dev-webhook-lambda","handler":"bootstrap","image_config":[],"image_uri":null,"kms_key_arn":null,"layers":null,"memory_size":128,"package_type":"Zip","publish":false,"replace_security_groups_on_destroy":null,"replacement_security_group_ids":null,"reserved_concurrent_executions":-1,"runtime":"provided.al2023","s3_bucket":null,"s3_key":null,"s3_object_version":null,"skip_destroy":false,"snap_start":[],"source_code_hash":"624c649d10ceb4d884b01fae601b1f511bae7df7f949799a1067b7d8a223d821","tags":null,"tags_all":{"ManagedByTerraform":"true","environment":"dev"},"timeout":3,"timeouts":null,"vpc_config":[]},"after_unknown":{"architectures":[false],"arn":true,"code_sha256":true,"dead_letter_config":[],"environment":[{"variables":true}],"ephemeral_storage":true,"file_system_config":[],"id":true,"image_config":[],"invoke_arn":true,"last_modified":true,"logging_config":true,"qualified_arn":true,"qualified_invoke_arn":true,"role":true,"signing_job_arn":true,"signing_profile_version_arn":true,"snap_start":[],"source_code_size":true,"tags_all":{},"tracing_config":true,"version":true,"vpc_config":[]},"before_sensitive":false,"after_sensitive":{"architectures":[false],"dead_letter_config":[],"environment":[{"variables":{}}],"ephemeral_storage":[],"file_system_config":[],"image_config":[],"logging_config":[],"snap_start":[],"tags_all":{},"tracing_config":[],"vpc_config":[]}}},{"address":"module.dynamodb_table.aws_dynamodb_table.table","module_address":"module.dynamodb_table","mode":"managed","type":"aws_dynamodb_table","name":"table","provider_name":"registry.opentofu.org/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"attribute":[{"name":"login","type":"S"},{"name":"repo-env","type":"S"}],"billing_mode":"PROVISIONED","deletion_protection_enabled":null,"global_secondary_index":[],"hash_key":"login","import_table":[],"local_secondary_index":[],"name":"deployment-webhooks-dev-table","range_key":"repo-env","read_capacity":5,"replica":[],"restore_date_time":null,"restore_source_name":null,"restore_source_table_arn":null,"restore_to_latest_time":null,"stream_enabled":null,"table_class":null,"tags":null,"tags_all":{"ManagedByTerraform":"true","environment":"dev"},"timeouts":null,"write_capacity":5},"after_unknown":{"arn":true,"attribute":[{},{}],"global_secondary_index":[],"id":true,"import_table":[],"local_secondary_index":[],"point_in_time_recovery":true,"replica":[],"server_side_encryption":true,"stream_arn":true,"stream_label":true,"stream_view_type":true,"tags_all":{},"ttl":true},"before_sensitive":false,"after_sensitive":{"attribute":[{},{}],"global_secondary_index":[],"import_table":[],"local_secondary_index":[],"point_in_time_recovery":[],"replica":[],"server_side_encryption":[],"tags_all":{},"ttl":[]}}},{"address":"module.github_PAT_secret.aws_secretsmanager_secret.this","module_address":"module.github_PAT_secret","mode":"managed","type":"aws_secretsmanager_secret","name":"this","provider_name":"registry.opentofu.org/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":"The secret for the GitHub PAT, used to approve requests.","force_overwrite_replica_secret":false,"kms_key_id":null,"name":"GITHUB_PAT_SECRET","recovery_window_in_days":0,"tags":null,"tags_all":{"ManagedByTerraform":"true","environment":"dev"}},"after_unknown":{"arn":true,"id":true,"name_prefix":true,"policy":true,"replica":true,"tags_all":{}},"before_sensitive":false,"after_sensitive":{"replica":[],"tags_all":{}}}},{"address":"module.github_PAT_secret.aws_secretsmanager_secret_version.this","module_address":"module.github_PAT_secret","mode":"managed","type":"aws_secretsmanager_secret_version","name":"this","provider_name":"registry.opentofu.org/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"secret_binary":null,"secret_string":"secret"},"after_unknown":{"arn":true,"id":true,"secret_id":true,"version_id":true,"version_stages":true},"before_sensitive":false,"after_sensitive":{"secret_binary":true,"secret_string":true,"version_stages":[]}}},{"address":"module.github_webhook_secret.aws_secretsmanager_secret.this","module_address":"module.github_webhook_secret","mode":"managed","type":"aws_secretsmanager_secret","name":"this","provider_name":"registry.opentofu.org/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":"The secret for the GitHub webhooks, used to verify payloads.","force_overwrite_replica_secret":false,"kms_key_id":null,"name":"GITHUB_WEBHOOK_SECRET","recovery_window_in_days":0,"tags":null,"tags_all":{"ManagedByTerraform":"true","environment":"dev"}},"after_unknown":{"arn":true,"id":true,"name_prefix":true,"policy":true,"replica":true,"tags_all":{}},"before_sensitive":false,"after_sensitive":{"replica":[],"tags_all":{}}}},{"address":"module.github_webhook_secret.aws_secretsmanager_secret_version.this","module_address":"module.github_webhook_secret","mode":"managed","type":"aws_secretsmanager_secret_version","name":"this","provider_name":"registry.opentofu.org/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"secret_binary":null,"secret_string":"secret2"},"after_unknown":{"arn":true,"id":true,"secret_id":true,"version_id":true,"version_stages":true},"before_sensitive":false,"after_sensitive":{"secret_binary":true,"secret_string":true,"version_stages":[]}}}],"output_changes":{"dynamodb_table_arn":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"dynamodb_table_name":{"actions":["create"],"before":null,"after":"deployment-webhooks-dev-table","after_unknown":false,"before_sensitive":false,"after_sensitive":false},"function_name":{"actions":["create"],"before":null,"after":"deployment-webhooks-dev-webhook-lambda","after_unknown":false,"before_sensitive":false,"after_sensitive":false},"invoke_arn":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false}},"prior_state":{"format_version":"1.0","terraform_version":"1.8.2","values":{"outputs":{"dynamodb_table_name":{"sensitive":false,"value":"deployment-webhooks-dev-table","type":"string"},"function_name":{"sensitive":false,"value":"deployment-webhooks-dev-webhook-lambda","type":"string"}},"root_module":{"resources":[{"address":"data.aws_iam_policy.lambda_basic_execution","mode":"data","type":"aws_iam_policy","name":"lambda_basic_execution","provider_name":"registry.opentofu.org/hashicorp/aws","schema_version":0,"values":{"arn":"arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole","attachment_count":0,"description":"Provides write permissions to CloudWatch Logs.","id":"arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole","name":"AWSLambdaBasicExecutionRole","path":"/service-role/","path_prefix":null,"policy":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:CreateLogGroup\",\n        \"logs:CreateLogStream\",\n        \"logs:PutLogEvents\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}","policy_id":"ANPAJNCQGXC42545SKXIK","tags":{}},"sensitive_values":{"tags":{}}},{"address":"data.aws_iam_policy.xray","mode":"data","type":"aws_iam_policy","name":"xray","provider_name":"registry.opentofu.org/hashicorp/aws","schema_version":0,"values":{"arn":"arn:aws:iam::aws:policy/AWSXRayDaemonWriteAccess","attachment_count":0,"description":"Allow the AWS X-Ray Daemon to relay raw trace segments data to the service's API and retrieve sampling data (rules, targets, etc.) to be used by the X-Ray SDK.","id":"arn:aws:iam::aws:policy/AWSXRayDaemonWriteAccess","name":"AWSXRayDaemonWriteAccess","path":"/","path_prefix":null,"policy":"{\n\t\"Version\": \"2012-10-17\",\n\t\"Statement\": [\n\t\t{\n\t\t\t\"Sid\": \"AWSXRayDaemonWriteAccess\",\n\t\t\t\"Effect\": \"Allow\",\n\t\t\t\"Action\": [\n\t\t\t\t\"xray:PutTraceSegments\",\n\t\t\t\t\"xray:PutTelemetryRecords\",\n\t\t\t\t\"xray:GetSamplingRules\",\n\t\t\t\t\"xray:GetSamplingTargets\",\n\t\t\t\t\"xray:GetSamplingStatisticSummaries\"\n\t\t\t],\n\t\t\t\"Resource\": [\n\t\t\t\t\"*\"\n\t\t\t]\n\t\t}\n\t]\n}","policy_id":"ANPAIOE47HSUE5AVBNEDM","tags":{}},"sensitive_values":{"tags":{}}},{"address":"data.aws_iam_policy_document.assume_role","mode":"data","type":"aws_iam_policy_document","name":"assume_role","provider_name":"registry.opentofu.org/hashicorp/aws","schema_version":0,"values":{"id":"2690255455","json":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"Service\": \"lambda.amazonaws.com\"\n      }\n    }\n  ]\n}","minified_json":"{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Action\":\"sts:AssumeRole\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"}}]}","override_json":null,"override_policy_documents":null,"policy_id":null,"source_json":null,"source_policy_documents":null,"statement":[{"actions":["sts:AssumeRole"],"condition":[],"effect":"Allow","not_actions":[],"not_principals":[],"not_resources":[],"principals":[{"identifiers":["lambda.amazonaws.com"],"type":"Service"}],"resources":[],"sid":""}],"version":"2012-10-17"},"sensitive_values":{"statement":[{"actions":[false],"condition":[],"not_actions":[],"not_principals":[],"not_resources":[],"principals":[{"identifiers":[false]}],"resources":[]}]}}]}}},"configuration":{"provider_config":{"aws":{"name":"aws","full_name":"registry.opentofu.org/hashicorp/aws","version_constraint":"5.64.0","expressions":{"allowed_account_ids":{"constant_value":["124355660096"]},"default_tags":[{"tags":{"constant_value":{"ManagedByTerraform":true,"environment":"dev"}}}],"profile":{"constant_value":"deployment-webhooks-dev"},"region":{"constant_value":"us-west-2"}}}},"root_module":{"outputs":{"dynamodb_table_arn":{"expression":{"references":["module.dynamodb_table.table_arn","module.dynamodb_table"]}},"dynamodb_table_name":{"expression":{"references":["module.dynamodb_table.table_name","module.dynamodb_table"]}},"function_name":{"expression":{"references":["aws_lambda_function.webhook.function_name","aws_lambda_function.webhook"]}},"invoke_arn":{"expression":{"references":["aws_lambda_function.webhook.invoke_arn","aws_lambda_function.webhook"]}}},"resources":[{"address":"aws_iam_policy.lambda_dynamodb_write_policy","mode":"managed","type":"aws_iam_policy","name":"lambda_dynamodb_write_policy","provider_config_key":"aws","expressions":{"description":{"constant_value":"Policy to allow Lambda functions to fetch from DynamoDB"},"name":{"constant_value":"lambda_dynamodb_policy"},"policy":{"references":["module.dynamodb_table.table_arn","module.dynamodb_table"]}},"schema_version":0},{"address":"aws_iam_policy.secret_access","mode":"managed","type":"aws_iam_policy","name":"secret_access","provider_config_key":"aws","expressions":{"name":{"constant_value":"secrets-access-policy"},"policy":{"references":["local.secret_arns"]}},"schema_version":0},{"address":"aws_iam_role.lambda_execution","mode":"managed","type":"aws_iam_role","name":"lambda_execution","provider_config_key":"aws","expressions":{"assume_role_policy":{"references":["data.aws_iam_policy_document.assume_role.json","data.aws_iam_policy_document.assume_role"]},"managed_policy_arns":{"references":["data.aws_iam_policy.lambda_basic_execution.arn","data.aws_iam_policy.lambda_basic_execution","aws_iam_policy.lambda_dynamodb_write_policy.arn","aws_iam_policy.lambda_dynamodb_write_policy","data.aws_iam_policy.xray.arn","data.aws_iam_policy.xray","aws_iam_policy.secret_access.arn","aws_iam_policy.secret_access"]},"name":{"references":["local.profile"]}},"schema_version":0},{"address":"aws_lambda_function.webhook","mode":"managed","type":"aws_lambda_function","name":"webhook","provider_config_key":"aws","expressions":{"architectures":{"constant_value":["arm64"]},"environment":[{"variables":{"references":["module.dynamodb_table.table_name","module.dynamodb_table","module.github_webhook_secret.secret_ARN","module.github_webhook_secret","module.github_PAT_secret.secret_ARN","module.github_PAT_secret"]}}],"filename":{"references":["local.zipped_lambda_file_path"]},"function_name":{"references":["local.profile"]},"handler":{"constant_value":"bootstrap"},"role":{"references":["aws_iam_role.lambda_execution.arn","aws_iam_role.lambda_execution"]},"runtime":{"references":["var.lambda_runtime"]},"source_code_hash":{"references":["local.zipped_lambda_file_path"]}},"schema_version":0},{"address":"data.aws_iam_policy.lambda_basic_execution","mode":"data","type":"aws_iam_policy","name":"lambda_basic_execution","provider_config_key":"aws","expressions":{"arn":{"constant_value":"arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"}},"schema_version":0},{"address":"data.aws_iam_policy.xray","mode":"data","type":"aws_iam_policy","name":"xray","provider_config_key":"aws","expressions":{"arn":{"constant_value":"arn:aws:iam::aws:policy/AWSXRayDaemonWriteAccess"}},"schema_version":0},{"address":"data.aws_iam_policy_document.assume_role","mode":"data","type":"aws_iam_policy_document","name":"assume_role","provider_config_key":"aws","expressions":{"statement":[{"actions":{"constant_value":["sts:AssumeRole"]},"effect":{"constant_value":"Allow"},"principals":[{"identifiers":{"constant_value":["lambda.amazonaws.com"]},"type":{"constant_value":"Service"}}]}]},"schema_version":0}],"module_calls":{"dynamodb_table":{"source":"../dynamodb","expressions":{"billing_mode":{"constant_value":"PROVISIONED"},"hash_key":{"constant_value":"login"},"range_key":{"constant_value":"repo-env"},"read_capacity":{"constant_value":5},"table_name":{"references":["local.profile"]},"write_capacity":{"constant_value":5}},"module":{"outputs":{"table_arn":{"expression":{"references":["aws_dynamodb_table.table.arn","aws_dynamodb_table.table"]},"description":"The ARN of the DynamoDB table."},"table_name":{"expression":{"references":["aws_dynamodb_table.table.name","aws_dynamodb_table.table"]},"description":"The name of the DynamoDB table."}},"resources":[{"address":"aws_dynamodb_table.table","mode":"managed","type":"aws_dynamodb_table","name":"table","provider_config_key":"aws","expressions":{"attribute":[{"name":{"references":["var.hash_key"]},"type":{"constant_value":"S"}}],"billing_mode":{"references":["var.billing_mode"]},"hash_key":{"references":["var.hash_key"]},"name":{"references":["var.table_name"]},"range_key":{"references":["var.range_key"]},"read_capacity":{"references":["var.read_capacity"]},"write_capacity":{"references":["var.write_capacity"]}},"schema_version":1}],"variables":{"billing_mode":{"default":"PROVISIONED","description":"The billing mode for the DynamoDB table."},"global_secondary_indexes":{"default":[],"description":"List of global secondary indexes"},"hash_key":{"description":"The name of the attribute to be used as the hash(partition) key."},"range_key":{"default":null,"description":"The name of the attribute to be used as the range(sort) key."},"read_capacity":{"default":5,"description":"The number of read capacity units for the table (required if billing_mode is PROVISIONED)."},"table_name":{"description":"The name of the DynamoDB table."},"write_capacity":{"default":5,"description":"The number of write capacity units for the table (required if billing_mode is PROVISIONED)."}}}},"github_PAT_secret":{"source":"../secret","expressions":{"secret_description":{"constant_value":"The secret for the GitHub PAT, used to approve requests."},"secret_name":{"references":["var.github_PAT_secret_name"]},"secret_string":{"references":["var.github_PAT_secret_string"]}},"module":{"outputs":{"secret_ARN":{"expression":{"references":["aws_secretsmanager_secret.this.arn","aws_secretsmanager_secret.this"]}},"secret_name":{"expression":{"references":["var.secret_name"]}}},"resources":[{"address":"aws_secretsmanager_secret.this","mode":"managed","type":"aws_secretsmanager_secret","name":"this","provider_config_key":"aws","expressions":{"description":{"references":["var.secret_description"]},"name":{"references":["var.secret_name"]},"recovery_window_in_days":{"constant_value":0}},"schema_version":0},{"address":"aws_secretsmanager_secret_version.this","mode":"managed","type":"aws_secretsmanager_secret_version","name":"this","provider_config_key":"aws","expressions":{"secret_id":{"references":["aws_secretsmanager_secret.this.id","aws_secretsmanager_secret.this"]},"secret_string":{"references":["local.secret_string"]}},"schema_version":0}],"variables":{"json_encode":{"default":false,"description":"flag to mark if secret string should be json encoded"},"secret_description":{"default":"","description":"description of the secret"},"secret_name":{"description":"name of the secret"},"secret_string":{"description":"secret string/secret value","sensitive":true}}}},"github_webhook_secret":{"source":"../secret","expressions":{"secret_description":{"constant_value":"The secret for the GitHub webhooks, used to verify payloads."},"secret_name":{"references":["var.github_webhook_secret_name"]},"secret_string":{"references":["var.github_webhook_secret_string"]}},"module":{"outputs":{"secret_ARN":{"expression":{"references":["aws_secretsmanager_secret.this.arn","aws_secretsmanager_secret.this"]}},"secret_name":{"expression":{"references":["var.secret_name"]}}},"resources":[{"address":"aws_secretsmanager_secret.this","mode":"managed","type":"aws_secretsmanager_secret","name":"this","provider_config_key":"aws","expressions":{"description":{"references":["var.secret_description"]},"name":{"references":["var.secret_name"]},"recovery_window_in_days":{"constant_value":0}},"schema_version":0},{"address":"aws_secretsmanager_secret_version.this","mode":"managed","type":"aws_secretsmanager_secret_version","name":"this","provider_config_key":"aws","expressions":{"secret_id":{"references":["aws_secretsmanager_secret.this.id","aws_secretsmanager_secret.this"]},"secret_string":{"references":["local.secret_string"]}},"schema_version":0}],"variables":{"json_encode":{"default":false,"description":"flag to mark if secret string should be json encoded"},"secret_description":{"default":"","description":"description of the secret"},"secret_name":{"description":"name of the secret"},"secret_string":{"description":"secret string/secret value","sensitive":true}}}}},"variables":{"aws_account_id":{"description":"The AWS account ID that is being deployed against. Used to configure allowed_account_ids."},"aws_region":{"description":"The AWS region being targeted (ex. us-west-2)"},"environment":{"description":"environment such as prod, dev, test"},"github_PAT_secret_name":{"default":"GITHUB_PAT_SECRET","description":"Secret name (or ARN) for GitHub Personal Access Token (PAT)"},"github_PAT_secret_string":{"description":"Secret string for github PAT","sensitive":true},"github_webhook_secret_name":{"default":"GITHUB_WEBHOOK_SECRET","description":"Secret name (or ARN) for github webhooks"},"github_webhook_secret_string":{"description":"Secret string for github webhook","sensitive":true},"lambda_runtime":{"default":"provided.al2023","description":"  Runtime for the lambda, i.e java21, python3.1, or \n  provided.al2023 (OS-only runtime) for languages like\n  Rust or Go. \n"},"project_name":{"description":"Name of app, such as reys-cool-project"}}}},"relevant_attributes":[{"resource":"aws_iam_policy.lambda_dynamodb_write_policy","attribute":["arn"]},{"resource":"aws_iam_policy.secret_access","attribute":["arn"]},{"resource":"aws_iam_role.lambda_execution","attribute":["arn"]},{"resource":"aws_lambda_function.webhook","attribute":["function_name"]},{"resource":"aws_lambda_function.webhook","attribute":["invoke_arn"]},{"resource":"data.aws_iam_policy.lambda_basic_execution","attribute":["arn"]},{"resource":"data.aws_iam_policy.xray","attribute":["arn"]},{"resource":"data.aws_iam_policy_document.assume_role","attribute":["json"]},{"resource":"module.dynamodb_table.aws_dynamodb_table.table","attribute":["name"]},{"resource":"module.dynamodb_table.aws_dynamodb_table.table","attribute":["arn"]},{"resource":"module.github_PAT_secret.aws_secretsmanager_secret.this","attribute":["id"]},{"resource":"module.github_PAT_secret.aws_secretsmanager_secret.this","attribute":["arn"]},{"resource":"module.github_webhook_secret.aws_secretsmanager_secret.this","attribute":["arn"]},{"resource":"module.github_webhook_secret.aws_secretsmanager_secret.this","attribute":["id"]}],"timestamp":"2024-10-30T05:47:39Z","errored":false}
